<html>
<head>
  <title>Login SIAKAD Polinema</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="login-body">
  <div class="login-container">
    <div class="login-left">
      <div class="kotak">
        <img src="images/Logo-Polinema.png" alt="Logo Polinema" class="logo">
        <h3 class="judul">LOGIN SIAKAD POLINEMA</h3>
      </div>
      <div class="login-form">
        <p>Masukkan Username dan Password<br>(Menggunakan NIM dan Password)</p>
        
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">

        <div class="checkbox">
          <input type="checkbox" id="showPass" onclick="togglePassword()">
          <label for="showPass">Tampilkan Password</label>
        </div>

        <button onclick="handleLogin()" class="button">LOGIN</button>

        <p id="errorMessage" style="color: red; margin-top: 10px;"></p>
      </div>
    </div>
    <div class="login-right"></div>
  </div>

  <script>
    
    function togglePassword() {
      const pass = document.getElementById("password");
      pass.type = pass.type === "password" ? "text" : "password";
    }

    // BAGIAN A
    async function handleLogin() {
      const usernameInput = document.getElementById('username');
      const passwordInput = document.getElementById('password');
      const errorMessage = document.getElementById('errorMessage');
      const loginData = {
        username: usernameInput.value,
        password: passwordInput.value
      };
    // BAGIAN B
      try {
        const response = await fetch('http://localhost:3000/login', {
          method: 'POST', 
          headers: {
            'Content-Type': 'application/json' 
          },
          body: JSON.stringify(loginData) 
        });
    // BAGIAN C
        const result = await response.json(); 

        if (response.ok) { 
          window.location.href = 'dashboard.html'; 
        } else {
         
          errorMessage.textContent = result.message;
        }
      } catch (error) {
       
        console.error('Error:', error);
        errorMessage.textContent = 'Tidak dapat terhubung ke server. Coba lagi nanti.';
      }
    }
  </script>
</body>
</html>